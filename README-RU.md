<p aling="center"><a href="https://github.com/snaplyze/remnawave-reverse-proxy">
 <picture>
   <source media="(prefers-color-scheme: dark)" srcset="./media/logo.png" />
   <source media="(prefers-color-scheme: light)" srcset="./media/logo-black.png" />
   <img alt="Remnawave Reverse Proxy" src="https://github.com/snaplyze/remnawave-reverse-proxy" />
 </picture>
</a></p>

<p align="center">
  <img src="./media/ru.png" alt="Русский" /> <strong>Русский</strong> | <img src="./media/us.png" alt="English" /> <a href="/README.md">English</a>
</p>

---

> [!CAUTION]
> **ЭТОТ РЕПОЗИТОРИЙ - УЧЕБНЫЙ ПРИМЕР ДЛЯ ИЗУЧЕНИЯ NGINX, РЕВЕРС-ПРОКСИ И ОСНОВ СЕТЕВОЙ БЕЗОПАСНОСТИ. ЭТОТ СКРИПТ ДЕМОНСТРИРУЕТ НАСТРОЙКУ NGINX КАК REVERSE PROXY. НЕ ДЛЯ ПРОДА И НЕ ДЛЯ ПРОДАКШН-ИСПОЛЬЗОВАНИЯ! ЕСЛИ ВЫ НЕ ПОНИМАЕТЕ КАК РАБОТАЕТ ПАНЕЛЬ УПРАВЛЕНИЯ - ЭТО ВАШИ ПРОБЛЕМЫ, А НЕ АВТОРА СКРИПТА. ИСПОЛЬЗУЙТЕ НА СВОЙ СТРАХ И РИСК!**

---

## Обзор

Данный скрипт автоматизации упрощает развертывание обратного прокси-сервера с использованием NGINX и XRAY, а также установку панели управления и ноды Remnawave. Архитектура оптимизирована для производительности: Xray работает непосредственно на порту 443 и перенаправляет трафик через Unix-сокет, который прослушивает NGINX, минимизируя накладные расходы TCP и улучшая надежность соединений.

> [!IMPORTANT]
> Поддержка Debian и Ubuntu. Cкрипт был протестирован в среде виртуализации KVM. Для корректной работы вам потребуется собственный домен. Рекомендуется запускать с правами root на свежеустановленной системе.

### Режимы развертывания

Скрипт поддерживает гибкие конфигурации развертывания:

**1. Режим одного сервера**
- Панель управления и XRAY нода установлены на одной машине
- Подходит для компактных установок с умеренным трафиком

**2. Распределенный режим**
- **Сервер панели**: Центр управления без XRAY ноды
- **Сервер ноды**: Размещает XRAY ноду с заглушкой SelfSteal для VLESS REALITY

### Требования к доменам

Подготовьте три домена или поддомена перед установкой:

1. **Панель управления**: Доступ к интерфейсу управления
2. **Страница подписок**: Распространение конфигураций клиентов
3. **Заглушка SelfSteal**: Маскировочный сайт, размещенный на сервере ноды

---

## Настройка доменов

Скрипт поддерживает два метода получения SSL-сертификатов:
- **Cloudflare**: Управление через API Cloudflare
- **ACME**: Прямая интеграция с хостинг-провайдером

### Примеры конфигурации DNS

#### Установка на одном сервере (панель + нода вместе)

| Тип записи | Имя               | Значение         | Статус прокси |
|------------|-------------------|------------------|---------------|
| A          | example.com       | your_server_ip   | DNS only      |
| CNAME      | panel.example.com | example.com      | DNS only      |
| CNAME      | sub.example.com   | example.com      | DNS only      |
| CNAME      | node.example.com  | example.com      | DNS only      |

> [!TIP]
> Запись `node.example.com` является необязательной для функциональности SelfSteal. Вы можете использовать корневой домен `example.com` вместо нее.

#### Распределенная установка (панель и нода на разных серверах)

| Тип записи | Имя               | Значение                | Статус прокси |
|------------|-------------------|-------------------------|---------------|
| A          | example.com       | panel_server_ip         | DNS only      |
| CNAME      | panel.example.com | example.com             | DNS only      |
| CNAME      | sub.example.com   | example.com             | DNS only      |
| A          | node.example.com  | node_server_ip          | DNS only      |

---

## Руководство по установке

### Развертывание на одном сервере

1. Запустите скрипт установки
2. Выберите **"Установка компонентов Remnawave"**
3. Выберите **"Установить панель и ноду на один сервер"**
4. Дождитесь завершения
5. Скрипт автоматически перезапустит сервисы и отобразит учетные данные для входа

### Распределенное развертывание

**Шаг 1: Настройка сервера панели**

1. Запустите скрипт установки на первом сервере
2. Выберите **"Установка компонентов Remnawave"**
3. Выберите **"Установить только панель"**
4. Сохраните предоставленные учетные данные

**Шаг 2: Экспорт сертификата**

1. Войдите в панель управления
2. Перейдите в **Ноды** → **Управление**
3. Выберите целевую ноду
4. Найдите поле **"Secret Key (SECRET_KEY)"**
5. Скопируйте сертификат, используя иконку копирования

**Шаг 3: Настройка сервера ноды**

1. Запустите скрипт установки на втором сервере
2. Выберите **"Установка компонентов Remnawave"**
3. Выберите **"Установить только ноду"**
4. Вставьте сертификат при запросе
5. Подтвердите сообщение об успешном подключении ноды

---

## Функции безопасности

### Защита доступа к панели

Конфигурация NGINX реализует аутентификацию на основе URL-параметра для защиты от несанкционированного обнаружения:

**Метод доступа**
```
https://panel.example.com/auth/login?<SECRET_KEY>=<SECRET_KEY>
```

**Как это работает**

1. URL-параметр автоматически устанавливает cookie в браузере
   - Имя cookie: `<SECRET_KEY>`
   - Значение cookie: `<SECRET_KEY>`

2. Требования доступа:
   - Должна присутствовать действительная cookie
   - URL должен содержать правильный параметр

3. Поведение при неудачном доступе:
   - Отсутствие cookie: Пустая страница или ошибка 404
   - Неверный параметр: Пустая страница или ошибка 404

Этот уровень защиты предотвращает:
- Обнаружение сканированием хоста
- Атаки перебора путей
- Попытки брутфорс доступа

Панель остается невидимой без правильного параметра аутентификации.

---

## Возможности

### Конфигурация прокси-сервера
- Автоматическое обновление конфигураций через подписку
- Поддержка JSON-подписки с конвертацией форматов для популярных клиентов
- Совместимость с основными прокси-клиентами

### Интеграция с NGINX
- Оптимизированная настройка обратного прокси с XRAY
- Коммуникация через Unix-сокет для снижения накладных расходов

### Реализация безопасности
- **Брандмауэр**: Конфигурация UFW для контроля доступа
- **SSL-сертификаты**: Cloudflare или ACME с автоматическим продлением
- **Управление IPv6**: Меры предотвращения уязвимостей
- **TCP оптимизация**: Алгоритм контроля перегрузки BBR
- **Маскировка**: Выбор случайного шаблона веб-сайта

---

## Быстрый старт

Выполните следующую команду для начала установки:
```bash
bash <(curl -Ls https://raw.githubusercontent.com/snaplyze/remnawave-reverse-proxy/refs/heads/main/install_remnawave.sh)
```

<p align="center">
  <img src="./media/remnawave-reverse-proxy.png" alt="Интерфейс установки" />
</p>

---

> [!CAUTION]
> **Этот репозиторий предназначен исключительно для образовательных целей и для изучения принципов работы обратных прокси-серверов и сетевой безопасности. Скрипт демонстрирует настройку прокси-сервера с использованием NGINX для реверс-прокси, управления трафиком и защиты от атак.**
>
> **Мы настоятельно напоминаем, что использование этого инструмента с целью обхода сетевых блокировок или цензуры является незаконным в ряде стран, где существуют законы, регулирующие использование технологий для обхода ограничений в интернете.**
>
> **Данный проект не предназначен для использования в целях, нарушающих законы о защите информации или вмешивающихся в механизмы цензуры. Мы не несем ответственности за возможные юридические последствия, связанные с использованием этого скрипта.**
>
> **Используйте этот инструмент/скрипт исключительно в демонстрационных целях, в качестве примера работы обратного прокси и защиты данных. Настоятельно рекомендуем удалить скрипт после ознакомления. Дальнейшее использование на ваш страх и риск.**
>
> **Если вы не уверены, нарушает ли использование данного инструмента или его компонентов законодательство вашей страны- откажитесь от любого взаимодействия с данным инструментом.**

## Сообщество

Присоединяйтесь к нашему Telegram-сообществу для поддержки и обсуждений:

**Telegram чат**: [https://t.me/remnawave_reverse](https://t.me/remnawave_reverse)

## Пожертвования

Если вам нравится этот проект и вы хотите поддержать его дальнейшее развитие, пожалуйста, рассмотрите возможность сделать пожертвование. Ваш вклад помогает финансировать будущие обновления и улучшения!

**Способы пожертвования:**

- **TON USDT:** `UQAxyZDwKUPQ5Bp09JOFcaDVakjYQT46rf3iP3lnl_qc9xVS`
